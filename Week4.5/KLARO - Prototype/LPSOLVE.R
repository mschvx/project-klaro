library(lpSolve)

# --- Data from your JSON ---
costs <- c(
  60, 18, 55, 25, 20, 30, 48, 12, 2, 15,
  6, 28, 24, 3.5, 4.2, 22, 10, 8, 3.2, 80,
  20, 6, 2, 36, 28, 1.8, 10, 2.5, 3, 9
)

# Pollutant reductions per project (rows = pollutants, cols = projects)
A <- matrix(c(
  # CO2
  0,0,0,1,0.9,2.8,3.2,0.6,0.02,0.1,0.4,0.2,0.15,0.04,0.06,0.5,0.05,0.02,0.04,2,0.3,0.01,0.01,2.2,1.9,0.02,0.03,0.03,0.02,0.4,
  # NOx
  0,0,0,0.2,0.4,0.6,0.9,0.1,0.01,0.05,6,0.1,0.05,0.02,0.01,0.3,0.01,0.01,0.02,0.4,0.05,0,0,0.6,0.8,0.01,0.02,0.01,0.01,0.05,
  # SO2
  0,0,0,0.1,0.2,0.8,1,0.4,0.7,0.05,0.4,0.05,0.03,0.01,0.03,0.15,0.01,0.02,0.9,1.2,0.1,0.01,0,0.6,0.7,0.6,0.02,0.4,0,0.05,
  # PM2.5
  0,0,0,1.5,0.1,0,0,0.05,0,0.02,0,8,6.5,0.8,0.6,0.2,4,7.2,0.1,0,0,2.5,0,0,0,0.05,3.2,0.05,0,0.01,
  # CH4
  0,0,0,0.5,0.05,0.5,0.7,0.2,0.01,0.02,0.1,0.2,0.1,0.03,0.02,0.1,0.02,0.05,0.02,0.6,0.05,0.01,6.5,0.3,0.2,0.01,0.01,0.02,0,0.3,
  # VOC
  0,0,0,2,1.2,5,6,3,1.5,0.5,0.6,0.1,0.05,0.1,0.15,1,0.02,0.02,2,10,0.5,0.01,0.1,4.2,3.6,1,0.05,1.2,0,2.5,
  # CO
  0,0,0,0.05,0.02,0.01,0.02,0.02,0.03,0,0.01,0,0,0.01,0.005,0.01,0,0.1,0.05,0.02,0.01,0.2,0,0.01,0.01,0.02,0.15,0.03,0,0.01,
  # NH3
  0,0,0,0.01,0.01,0.05,0.03,0.02,0.2,0,0.01,0,0,0.01,0.005,0.01,0,0,0.05,0.02,0.01,0,0,0.01,0.01,0.02,0.02,0.1,0,0.01,
  # Black Carbon
  0,0,0,0.3,0.05,0.02,0.03,0.01,0,0.01,0,0.05,0.03,0.005,0.002,0.03,0.01,0.05,0,0.05,0.01,0.02,0,0.02,0.02,0,0.04,0,1.5,0.01,
  # N2O
  0,0,0,0.3,0.05,0.02,0.03,0.01,0,0.01,0,0.05,0.03,0.005,0.002,0.03,0.01,0.05,0,0.05,0.01,0.02,0,0.02,0.02,0,0.04,0,1.5,0.01
), nrow=10, byrow=TRUE)

# Pollution reduction targets
b <- c(1000, 35, 25, 20, 60, 45, 80, 12, 6, 10)
dir <- rep(">=", 10)

# Solve the LP
solution <- lp("min", costs, A, dir, b)

# Print results
cat("Optimal Total Cost:", solution$objval, "\n\n")
cat("Optimal Units for Each Project:\n")
print(solution$solution)
